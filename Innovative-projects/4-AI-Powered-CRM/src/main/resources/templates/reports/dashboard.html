<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports - CRM Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @keyframes fade-in {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        @keyframes gradient-bg {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .fade-in { animation: fade-in 0.6s ease-out forwards; }
        .gradient-bg { 
            background: linear-gradient(-45deg, #f8fafc, #e2e8f0, #cbd5e1, #94a3b8);
            background-size: 400% 400%;
            animation: gradient-bg 20s ease infinite;
        }
        .dark .gradient-bg {
            background: linear-gradient(-45deg, #0f172a, #1e293b, #334155, #475569);
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class'
        }
    </script>
</head>
<body class="h-full gradient-bg">
    <!-- Navigation -->
    <div th:replace="fragments/navbar :: navbar"></div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Header -->
        <div class="mb-8 fade-in">
            <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">
                <i class="fas fa-file-alt text-indigo-500 mr-3"></i>Reports & Export
            </h1>
            <p class="text-gray-600 dark:text-gray-400">Generate and export business reports</p>
        </div>

        <!-- Report Summary -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 fade-in">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Customer Report</h3>
                    <i class="fas fa-users text-blue-500 text-xl"></i>
                </div>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Complete customer database with contact information and status</p>
                <div class="text-2xl font-bold text-gray-900 dark:text-white mb-2" th:text="${analytics.totalCustomers}">0</div>
                <p class="text-sm text-gray-500 dark:text-gray-500">Total Records</p>
            </div>

            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 fade-in" style="animation-delay: 0.1s;">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Revenue Report</h3>
                    <i class="fas fa-dollar-sign text-green-500 text-xl"></i>
                </div>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Financial performance and revenue tracking</p>
                <div class="text-2xl font-bold text-gray-900 dark:text-white mb-2" th:text="'$' + ${analytics.totalRevenue}">$0</div>
                <p class="text-sm text-gray-500 dark:text-gray-500">Total Revenue</p>
            </div>

            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 fade-in" style="animation-delay: 0.2s;">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Pipeline Report</h3>
                    <i class="fas fa-chart-line text-purple-500 text-xl"></i>
                </div>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Sales pipeline and conversion metrics</p>
                <div class="text-2xl font-bold text-gray-900 dark:text-white mb-2" th:text="${analytics.conversionRate} + '%'">0%</div>
                <p class="text-sm text-gray-500 dark:text-gray-500">Conversion Rate</p>
            </div>
        </div>

        <!-- Export Options -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-8 fade-in" style="animation-delay: 0.3s;">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">
                <i class="fas fa-download text-indigo-500 mr-2"></i>Export Data
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Customer Export -->
                <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/50 rounded-lg flex items-center justify-center mr-4">
                            <i class="fas fa-users text-blue-600 dark:text-blue-400 text-xl"></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">Customer Data</h4>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Complete customer list</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Export all customer information including contact details, status, and lead scores.</p>
                    <a href="/reports/export/csv" class="w-full inline-flex items-center justify-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                        <i class="fas fa-file-csv mr-2"></i>Export CSV
                    </a>
                </div>

                <!-- Analytics Export -->
                <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-green-100 dark:bg-green-900/50 rounded-lg flex items-center justify-center mr-4">
                            <i class="fas fa-chart-bar text-green-600 dark:text-green-400 text-xl"></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">Analytics Report</h4>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Business metrics</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Generate comprehensive analytics report with key performance indicators.</p>
                    <button class="w-full inline-flex items-center justify-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors" onclick="generateAnalyticsReport()">
                        <i class="fas fa-chart-pie mr-2"></i>Generate Report
                    </button>
                </div>

                <!-- Custom Export -->
                <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900/50 rounded-lg flex items-center justify-center mr-4">
                            <i class="fas fa-cogs text-purple-600 dark:text-purple-400 text-xl"></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white">Custom Report</h4>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Tailored export</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Create custom reports with specific date ranges and filtered data.</p>
                    <button class="w-full inline-flex items-center justify-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors" onclick="showCustomReportModal()">
                        <i class="fas fa-filter mr-2"></i>Customize
                    </button>
                </div>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="mt-8 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 fade-in" style="animation-delay: 0.4s;">
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-6">
                <i class="fas fa-history text-gray-500 mr-2"></i>Export History
            </h3>
            <div class="space-y-4">
                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-blue-100 dark:bg-blue-900/50 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-file-csv text-blue-600 dark:text-blue-400"></i>
                        </div>
                        <div>
                            <p class="font-medium text-gray-900 dark:text-white">Customer Database Export</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Generated on demand</p>
                        </div>
                    </div>
                    <span class="text-sm text-gray-500 dark:text-gray-400">Available for download</span>
                </div>
                
                <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                    <i class="fas fa-clock text-2xl mb-2"></i>
                    <p>Export history will appear here after generating reports</p>
                </div>
            </div>
        </div>
    </div>

    <div th:replace="fragments/navbar :: darkmode-script"></div>
    <script>

        function generateAnalyticsReport() {
            // Create analytics report content
            const analytics = {
                totalCustomers: /*[[${analytics.totalCustomers}]]*/ 0,
                totalRevenue: /*[[${analytics.totalRevenue}]]*/ 0,
                conversionRate: /*[[${analytics.conversionRate}]]*/ 0,
                leadCount: /*[[${analytics.leadCount}]]*/ 0,
                prospectCount: /*[[${analytics.prospectCount}]]*/ 0,
                customerCount: /*[[${analytics.customerCount}]]*/ 0
            };

            const reportContent = `CRM Analytics Report
Generated: ${new Date().toLocaleString()}

=== KEY METRICS ===
Total Customers: ${analytics.totalCustomers}
Total Revenue: $${analytics.totalRevenue}
Conversion Rate: ${analytics.conversionRate}%

=== PIPELINE BREAKDOWN ===
Active Leads: ${analytics.leadCount}
Qualified Prospects: ${analytics.prospectCount}
Paying Customers: ${analytics.customerCount}

=== PERFORMANCE SUMMARY ===
Pipeline Health: ${analytics.leadCount + analytics.prospectCount > 0 ? 'Active' : 'Needs Attention'}
Revenue Status: ${analytics.totalRevenue > 0 ? 'Generating Revenue' : 'No Revenue Yet'}
Growth Potential: ${analytics.conversionRate > 10 ? 'High' : analytics.conversionRate > 5 ? 'Medium' : 'Low'}
`;

            // Download as text file
            const blob = new Blob([reportContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `analytics_report_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function showCustomReportModal() {
            alert('Custom report builder coming soon! For now, use the standard exports available.');
        }
    </script>
</body>
</html>